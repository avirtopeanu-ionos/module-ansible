- hosts: localhost
  connection: local
  gather_facts: false

  vars_files:
    - vars.yml

  tasks:
    - name: Create datacenter
      ionos_cloud_datacenter:
          name: "{{ name }}"
          location: "{{ location }}"

    - name: Create public LAN
      ionos_cloud_lan:
        datacenter: "{{ name }}"
        name: "{{ lan }}"
        public: true

    - name: Update LAN
      ionos_cloud_lan:
        datacenter: "{{ name }}"
        name: "{{ lan }}"
        public: false
        state: update

    - name: Remove LAN
      ionos_cloud_lan:
        datacenter: "{{ name }}"
        name: "{{ lan }}"
        state: absent

    - name: Remove datacenter
      ionos_cloud_datacenter:
        name: "{{ name }}"
        state: absent